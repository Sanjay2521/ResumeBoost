"use strict";exports.id=78,exports.ids=[78],exports.modules={98078:(e,t,r)=>{r.d(t,{qL:()=>X.qL});var s=r(14353),n=r(22025),i=r(45797);function a(e,t){if("undefined"==typeof Convex||void 0===Convex.syscall)throw Error("The Convex database and auth objects are being used outside of a Convex backend. Did you mean to use `useQuery` or `useMutation` to call a Convex function?");return JSON.parse(Convex.syscall(e,JSON.stringify(t)))}async function o(e,t){let r;if("undefined"==typeof Convex||void 0===Convex.asyncSyscall)throw Error("The Convex database and auth objects are being used outside of a Convex backend. Did you mean to use `useQuery` or `useMutation` to call a Convex function?");try{r=await Convex.asyncSyscall(e,JSON.stringify(t))}catch(e){if(void 0!==e.data){let t=new n.P(e.message);throw t.data=(0,i.sq)(e.data),t}throw Error(e.message)}return JSON.parse(r)}r(70088);var l=Object.defineProperty,u=(e,t,r)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c=(e,t,r)=>u(e,"symbol"!=typeof t?t+"":t,r);class h{constructor(){c(this,"_isExpression"),c(this,"_value")}}var d=Object.defineProperty,m=(e,t,r)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t,r)=>m(e,"symbol"!=typeof t?t+"":t,r);class p extends h{constructor(e){super(),y(this,"inner"),this.inner=e}serialize(){return this.inner}}function v(e){return e instanceof p?e.serialize():{$literal:(0,i.h_)(e)}}var f=Object.defineProperty,b=(e,t,r)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t,r)=>b(e,"symbol"!=typeof t?t+"":t,r);class x{constructor(){g(this,"_isExpression"),g(this,"_value")}}var w=Object.defineProperty,q=(e,t,r)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E=(e,t,r)=>q(e,"symbol"!=typeof t?t+"":t,r);class I extends x{constructor(e){super(),E(this,"inner"),this.inner=e}serialize(){return this.inner}}function C(e){return e instanceof I?e.serialize():{$literal:(0,i.h_)(e)}}let $={eq:(e,t)=>new I({$eq:[C(e),C(t)]}),neq:(e,t)=>new I({$neq:[C(e),C(t)]}),lt:(e,t)=>new I({$lt:[C(e),C(t)]}),lte:(e,t)=>new I({$lte:[C(e),C(t)]}),gt:(e,t)=>new I({$gt:[C(e),C(t)]}),gte:(e,t)=>new I({$gte:[C(e),C(t)]}),add:(e,t)=>new I({$add:[C(e),C(t)]}),sub:(e,t)=>new I({$sub:[C(e),C(t)]}),mul:(e,t)=>new I({$mul:[C(e),C(t)]}),div:(e,t)=>new I({$div:[C(e),C(t)]}),mod:(e,t)=>new I({$mod:[C(e),C(t)]}),neg:e=>new I({$neg:C(e)}),and:(...e)=>new I({$and:e.map(C)}),or:(...e)=>new I({$or:e.map(C)}),not:e=>new I({$not:C(e)}),field:e=>new I({$field:e})};var j=Object.defineProperty,P=(e,t,r)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,k=(e,t,r)=>P(e,"symbol"!=typeof t?t+"":t,r);class _{constructor(){k(this,"_isIndexRange")}}var S=Object.defineProperty,O=(e,t,r)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,N=(e,t,r)=>O(e,"symbol"!=typeof t?t+"":t,r);class F extends _{constructor(e){super(),N(this,"rangeExpressions"),N(this,"isConsumed"),this.rangeExpressions=e,this.isConsumed=!1}static new(){return new F([])}consume(){if(this.isConsumed)throw Error("IndexRangeBuilder has already been used! Chain your method calls like `q => q.eq(...).eq(...)`. See https://docs.convex.dev/using/indexes");this.isConsumed=!0}eq(e,t){return this.consume(),new F(this.rangeExpressions.concat({type:"Eq",fieldPath:e,value:(0,i.h_)(t)}))}gt(e,t){return this.consume(),new F(this.rangeExpressions.concat({type:"Gt",fieldPath:e,value:(0,i.h_)(t)}))}gte(e,t){return this.consume(),new F(this.rangeExpressions.concat({type:"Gte",fieldPath:e,value:(0,i.h_)(t)}))}lt(e,t){return this.consume(),new F(this.rangeExpressions.concat({type:"Lt",fieldPath:e,value:(0,i.h_)(t)}))}lte(e,t){return this.consume(),new F(this.rangeExpressions.concat({type:"Lte",fieldPath:e,value:(0,i.h_)(t)}))}export(){return this.consume(),this.rangeExpressions}}var Q=Object.defineProperty,T=(e,t,r)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,R=(e,t,r)=>T(e,"symbol"!=typeof t?t+"":t,r);class M{constructor(){R(this,"_isSearchFilter")}}function V(e,t,r,s){if(void 0===e)throw TypeError(`Must provide arg ${t} \`${s}\` to \`${r}\``)}var z=Object.defineProperty,B=(e,t,r)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,D=(e,t,r)=>B(e,"symbol"!=typeof t?t+"":t,r);class J extends M{constructor(e){super(),D(this,"filters"),D(this,"isConsumed"),this.filters=e,this.isConsumed=!1}static new(){return new J([])}consume(){if(this.isConsumed)throw Error("SearchFilterBuilder has already been used! Chain your method calls like `q => q.search(...).eq(...)`.");this.isConsumed=!0}search(e,t){return V(e,1,"search","fieldName"),V(t,2,"search","query"),this.consume(),new J(this.filters.concat({type:"Search",fieldPath:e,value:t}))}eq(e,t){return V(e,1,"eq","fieldName"),2!=arguments.length&&V(t,2,"search","value"),this.consume(),new J(this.filters.concat({type:"Eq",fieldPath:e,value:(0,i.h_)(t)}))}export(){return this.consume(),this.filters}}var L=r(45106),A=Object.defineProperty,G=(e,t,r)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,H=(e,t,r)=>G(e,"symbol"!=typeof t?t+"":t,r);function K(e){throw Error("consumed"===e?"This query is closed and can't emit any more values.":"This query has been chained with another operator and can't be reused.")}Symbol.asyncIterator;class U{constructor(e){H(this,"state"),H(this,"tableNameForErrorMessages"),this.state={type:"preparing",query:e},"FullTableScan"===e.source.type?this.tableNameForErrorMessages=e.source.tableName:this.tableNameForErrorMessages=e.source.indexName.split(".")[0]}takeQuery(){if("preparing"!==this.state.type)throw Error("A query can only be chained once and can't be chained after iteration begins.");let e=this.state.query;return this.state={type:"closed"},e}startQuery(){if("executing"===this.state.type)throw Error("Iteration can only begin on a query once.");("closed"===this.state.type||"consumed"===this.state.type)&&K(this.state.type);let{queryId:e}=a("1.0/queryStream",{query:this.state.query,version:L.i});return this.state={type:"executing",queryId:e},e}closeQuery(){"executing"===this.state.type&&a("1.0/queryCleanup",{queryId:this.state.queryId}),this.state={type:"consumed"}}order(e){V(e,1,"order","order");let t=this.takeQuery();if("Search"===t.source.type)throw Error("Search queries must always be in relevance order. Can not set order manually.");if(null!==t.source.order)throw Error("Queries may only specify order at most once");return t.source.order=e,new U(t)}filter(e){V(e,1,"filter","predicate");let t=this.takeQuery();if(t.operators.length>=256)throw Error("Can't construct query with more than 256 operators");return t.operators.push({filter:C(e($))}),new U(t)}limit(e){V(e,1,"limit","n");let t=this.takeQuery();return t.operators.push({limit:e}),new U(t)}[Symbol.asyncIterator](){return this.startQuery(),this}async next(){("closed"===this.state.type||"consumed"===this.state.type)&&K(this.state.type);let e="preparing"===this.state.type?this.startQuery():this.state.queryId,{value:t,done:r}=await o("1.0/queryStreamNext",{queryId:e});return r&&this.closeQuery(),{value:(0,s.sq)(t),done:r}}return(){return this.closeQuery(),Promise.resolve({done:!0,value:void 0})}async paginate(e){if(V(e,1,"paginate","options"),"number"!=typeof e?.numItems||e.numItems<0)throw Error(`\`options.numItems\` must be a positive number. Received \`${e?.numItems}\`.`);let t=this.takeQuery(),r=e.numItems,n=e.cursor,i=e?.endCursor??null,a=e.maximumRowsRead??null,{page:l,isDone:u,continueCursor:c,splitCursor:h,pageStatus:d}=await o("1.0/queryPage",{query:t,cursor:n,endCursor:i,pageSize:r,maximumRowsRead:a,maximumBytesRead:e.maximumBytesRead,version:L.i});return{page:l.map(e=>(0,s.sq)(e)),isDone:u,continueCursor:c,splitCursor:h,pageStatus:d}}async collect(){let e=[];for await(let t of this)e.push(t);return e}async take(e){return V(e,1,"take","n"),function(e,t,r,s){if(!Number.isInteger(e)||e<0)throw TypeError(`Arg 1 \`n\` to \`${r}\` must be a non-negative integer`)}(e,0,"take",0),this.limit(e).collect()}async first(){let e=await this.take(1);return 0===e.length?null:e[0]}async unique(){let e=await this.take(2);if(0===e.length)return null;if(2===e.length)throw Error(`unique() query returned more than one result from table ${this.tableNameForErrorMessages}:
 [${e[0]._id}, ${e[1]._id}, ...]`);return e[0]}}var W=r(43593);W.v.object({numItems:W.v.number(),cursor:W.v.union(W.v.string(),W.v.null()),endCursor:W.v.optional(W.v.union(W.v.string(),W.v.null())),id:W.v.optional(W.v.number()),maximumRowsRead:W.v.optional(W.v.number()),maximumBytesRead:W.v.optional(W.v.number())});var X=r(10790),Y=Object.defineProperty,Z=(e,t,r)=>t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ee=(e,t,r)=>Z(e,"symbol"!=typeof t?t+"":t,r),et=Object.defineProperty,er=(e,t,r)=>t in e?et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,es=(e,t,r)=>er(e,"symbol"!=typeof t?t+"":t,r);class en{constructor(e){es(this,"indexes"),es(this,"searchIndexes"),es(this,"vectorIndexes"),es(this,"validator"),this.indexes=[],this.searchIndexes=[],this.vectorIndexes=[],this.validator=e}" indexes"(){return this.indexes}index(e,t){return this.indexes.push({indexDescriptor:e,fields:t}),this}searchIndex(e,t){return this.searchIndexes.push({indexDescriptor:e,searchField:t.searchField,filterFields:t.filterFields||[]}),this}vectorIndex(e,t){return this.vectorIndexes.push({indexDescriptor:e,vectorField:t.vectorField,dimensions:t.dimensions,filterFields:t.filterFields||[]}),this}self(){return this}export(){let e=this.validator.json;if("object"!=typeof e)throw Error("Invalid validator: please make sure that the parameter of `defineTable` is valid (see https://docs.convex.dev/database/schemas)");return{indexes:this.indexes,searchIndexes:this.searchIndexes,vectorIndexes:this.vectorIndexes,documentType:e}}}function ei(e){return new en((0,W.h)(e)?e:W.v.object(e))}class ea{constructor(e,t){es(this,"tables"),es(this,"strictTableNameTypes"),es(this,"schemaValidation"),this.tables=e,this.schemaValidation=t?.schemaValidation===void 0||t.schemaValidation}export(){return JSON.stringify({tables:Object.entries(this.tables).map(([e,t])=>{let{indexes:r,searchIndexes:s,vectorIndexes:n,documentType:i}=t.export();return{tableName:e,indexes:r,searchIndexes:s,vectorIndexes:n,documentType:i}}),schemaValidation:this.schemaValidation})}}new ea({_scheduled_functions:ei({name:W.v.string(),args:W.v.array(W.v.any()),scheduledTime:W.v.float64(),completedTime:W.v.optional(W.v.float64()),state:W.v.union(W.v.object({kind:W.v.literal("pending")}),W.v.object({kind:W.v.literal("inProgress")}),W.v.object({kind:W.v.literal("success")}),W.v.object({kind:W.v.literal("failed"),error:W.v.string()}),W.v.object({kind:W.v.literal("canceled")}))}),_storage:ei({sha256:W.v.string(),size:W.v.float64(),contentType:W.v.optional(W.v.string())})},void 0)}};